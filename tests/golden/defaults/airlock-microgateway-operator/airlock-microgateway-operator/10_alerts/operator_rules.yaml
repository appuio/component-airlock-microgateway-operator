apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  labels:
    name: operator-rules
  name: operator-rules
  namespace: syn-airlock-microgateway
spec:
  groups:
    - name: airlock-microgateway-license.rules
      rules:
        - alert: AirlockMicrogatewayLicenseExpiresSoon
          annotations:
            description: The Airlock Microgateway license expires in {{ $value|humanizeDuration
              }}. Contact the customer/Ergon to renew the license.
            summary: Airlock Microgateway license expires in less than a month
          expr: max(microgateway_license_expiry_timestamp_seconds) - time() < 30*24*3600
          labels:
            severity: warning
            syn: 'true'
            syn_component: airlock-microgateway-operator
        - alert: AirlockMicrogatewayLicenseExpiresVerySoon
          annotations:
            description: The Airlock Microgateway license expires in {{ $value|humanizeDuration
              }}. Contact the customer/Ergon to renew the license.
            summary: Airlock Microgateway license expires in less than 10 days
          expr: max(microgateway_license_expiry_timestamp_seconds) - time() < 10*24*3600
          labels:
            severity: critical
            syn: 'true'
            syn_component: airlock-microgateway-operator
